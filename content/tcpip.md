Title: 谈谈TCP/IP协议
Date: 2017-08-06 11:20
Category: 网络
Tags: TCP/IP, 网络
Slug: tcpip
Author: Chen Kai
Summary: TCP/IP 协议是互联网的基础，在工作中总是会遇到各种各样的问题，下面对TCP/IP 协议进行了一些总结。

TCP/IP 协议是互联网的基础，在工作中总是会遇到各种各样的问题，下面对TCP/IP 协议进行了一些总结。TCP/IP协议基本上等同于整个网络协议族，协议中通过分层来工作，以适应不同的网络和不同的业务需求，在分层中，上层协议通过下层协议来工作，下层协议为上层提供服务。下面主要讲传输层的部分，最主要是讲TCP协议。

### 一、TCP 报文格式
TCP报文包括TCP首部和TCP数据，格式如下：
![](https://i.loli.net/2017/08/06/59868e0e7ddf5.png)
* 由图可见，TCP报文不包含IP地址和MAC地址，那是下层协议的事。

* 报文包含了源端口和目的端口号，报文需要通过(srdAddr, srcPort, desAddr, desPort, protocol) 来确定一个连接。

* 32 位序号和32 位确认号，是用来解决乱序和重传问题。

* TCP标志位，来标志报文类型，比如同步报文(SYN)或者应答报文(ACK)，窗口大小用来进行流控，也就是滑动窗口。

TCP将用户数据打包构成报文段;它发送数据后启动一个定时器;另一端对收到的数据进行确认，对失序的数据重新排序，丢弃重复数据;TCP提供端到端的流量控制，并计算和验证一个强制性的端到端检验。

### 二、TCP 连接与状态转换

TCP 通过三次握手来建立连接，并通过四次挥手来断开连接。

  ​

