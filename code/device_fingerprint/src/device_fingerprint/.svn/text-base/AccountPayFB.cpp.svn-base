#include "AccountPayFB.h"

IMPL_LOGGER(AccountPayFB, logger);

AccountPayFB::AccountPayFB(const std::string  &cmd_type):
        HTTPRequest(cmd_type) {
    LOG4CPLUS_DEBUG(logger, __FUNCTION__ << "(" << this << ")");
    std::map<std::string, std::pair<std::string, bool> > ext_params = {
            { "suc", std::make_pair(PARAM_TYPE_STRING, true) },//true/false
            { "cno", std::make_pair(PARAM_TYPE_STRING, true) }, //客户 id, 没有就不传
            { "carno", std::make_pair(PARAM_TYPE_STRING, true) }, //银行卡卡号(md5)
            { "msg", std::make_pair(PARAM_TYPE_STRING, false) }, //文字描述, 用于描述注册失原因描述
    };

    m_params.insert(ext_params.begin(), ext_params.end());

    tb_name = g_config_reader->get_string("account_service.db.tablename.account.payfb", "tb_account_pay_fb");
}

AccountPayFB::~AccountPayFB()
{
    LOG4CPLUS_DEBUG(logger, __FUNCTION__ << "(" << "destruction function" << ")");
}

int AccountPayFB::handle(json::Value& jsPara) {
    LOG4CPLUS_DEBUG(logger, __FUNCTION__ << "(" << this << ")");
    if(HTTPRequest::handle(jsPara) == 0)
    {
        return doAssembleSql();
    }
    return -1;
}

void AccountPayFB::doAssembleParam()
{
    LOG4CPLUS_DEBUG(logger, __FUNCTION__ << "(" << this << ")");
    HTTPRequest::doAssembleParam();
    //jsReturn["res"] = res;
}

